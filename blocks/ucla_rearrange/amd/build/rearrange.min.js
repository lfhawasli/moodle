define(["jquery","block_ucla_rearrange/jquery.mjs.nestedSortable"],function(a){var b=".section-zero",c=function(){a("#s-list").nestedSortable({handle:"div",items:"li",listType:"ul",toleranceElement:"> div",cancel:b+" > div",doNotClear:!0,isAllowed:function(a,c,d){if(d.is(".section-item:not(.section-zero)")){var e=a.nextAll(b).length>0;return!e}return!0},protectRoot:!0,forcePlaceholderSize:!0,opacity:.6,placeholder:"placeholder",revert:200,tabSize:32,excludeRoot:!0,stop:d}),d()},d=function(){var b=JSON.stringify(a("#s-list").nestedSortable("toHierarchy"));a("#serialized").val(b)},e=function(b){var c=b.closest(".section-item");c.children("ul").slideToggle(),b.text("Collapse"==b.text()?"Expand":"Collapse");var d;a(".expand-button").each(function(b){return 0==b?void(d=a(this).text()):void(d!=a(this).text()&&(d=!1))}),d&&a(".expandall").val("Expand"==d?"Expand all":"Collapse all")},f=function(){var b=a(".expandall");"Expand all"==b.first().val()?(a(".section-item").children("ul").slideDown(),a(".expand-button").text("Collapse"),b.val("Collapse all")):(a(".section-item").children("ul").slideUp(),a(".expand-button").text("Expand"),b.val("Expand all"))};return{init:function(b,d){if(c(),a(".expand-button").click(function(){e(a(this))}),a(".expandall").click(f),b>=0){var g=a(".section-item:not(#s-section-"+d+")");g.children("ul").hide(),g.find(".expand-button").text("Expand"),a(".expandall").val("Expand all")}}}});