define(["jquery","block_ucla_rearrange/jquery.mjs.nestedSortable"],function(a){var b=function(){a("#s-list").nestedSortable({handle:"div",items:"li",listType:"ul",toleranceElement:"> div",cancel:"#s-list > li:first-child()",doNotClear:!0,isAllowed:function(a,b,c){var d=c.hasClass("s-list-item"),e=a.nextAll("#s-section-1901").length>0;return!(d&&e)},protectRoot:!0,forcePlaceholderSize:!0,opacity:.6,placeholder:"placeholder",revert:200,tabSize:32,excludeRoot:!0,stop:c}),c()},c=function(){serialized=JSON.stringify(a("#s-list").nestedSortable("toHierarchy")),a("#serialized").val(serialized)},d=function(b){var c=b.closest(".section-item");c.children("ul").slideToggle(),b.text("Collapse"==b.text()?"Expand":"Collapse");var d;a(".expand-button").each(function(b){return 0==b?void(d=a(this).text()):void(d!=a(this).text()&&(d=!1))}),d&&a(".expandall").val("Expand"==d?"Expand all":"Collapse all")},e=function(){var b=a(".expandall");"Expand all"==b.first().val()?(a(".section-item").children("ul").slideDown(),a(".expand-button").text("Collapse"),b.val("Collapse all")):(a(".section-item").children("ul").slideUp(),a(".expand-button").text("Expand"),b.val("Expand all"))};return{init:function(c,f){if(b(),a(".expand-button").click(function(){d(a(this))}),a(".expandall").click(e),c>=0){var g=a(".section-item:not(#s-section-"+f+")");g.children("ul").hide(),g.find(".expand-button").text("Expand"),a(".expandall").val("Expand all")}}}});