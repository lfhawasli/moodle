define(["jquery","jwplayer"],function(a,b){return{init:function(c,d,e,f,g){var h="player-"+d,i=b(h);1===g?i.setup({autostart:!0,width:"100%",aspectratio:"3:2",playlist:[{sources:[{file:e},{file:f}]}],primary:"html5"}):i.setup({autostart:!0,image:M.cfg.wwwroot+"/filter/oidwowza/pix/audio-only.png",sources:[{file:f},{file:e}],rtmp:{bufferlength:3},modes:[{type:"html5"},{type:"flash"}],height:200});var j=0,k=!1,l=!1,m=new URL(window.location).searchParams;m.get("offset")&&(j=m.get("offset"),k=!0),i.on("ready",function(){k===!0&&i.play()}),i.on("firstFrame",function(){i.seek(j)}),g||l||i.on("time",function(){!l&&isFinite(i.getDuration())&&(i.seek(j),l=!0)});var n=function(){var a=parseInt(i.getPosition(),10);a===parseInt(i.getDuration(),10)&&(a="FINISHED"),M.util.set_user_preference(c,a)};setInterval(n,3e4),a(window).on("beforeunload",function(){n()})}}});