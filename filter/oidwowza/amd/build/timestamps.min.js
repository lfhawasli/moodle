define(["jquery","jwplayer"],function(t,e){return{init:function(i,n,o,a,r,s,f,l){var w=e("player-"+n),u={localization:{settings:M.util.get_string("playbackrates","filter_oidwowza"),rewind:M.util.get_string("rewind","filter_oidwowza")}};1===a?(u.autostart=!0,u.width="100%",u.aspectratio="3:2",u.primary="html5",u.playlist=[{sources:[{file:o},{file:s}]}],"vidres"===r&&(f&&(u.playlist[0].tracks=[{file:f,kind:"captions",default:!0}]),l&&(u.plugins={"hd-2":{file:l,state:!0}}))):(u.image=M.cfg.wwwroot+"/filter/oidwowza/pix/audio-only.png",u.height=200,u.autostart=!0,u.sources=[{file:s},{file:o}],u.rtmp={bufferlength:3},u.modes=[{type:"html5"},{type:"flash"}]),w.setup(u);var c=0,d=!1,p=!1,g=!1,y=M.util.get_string("skipahead","filter_oidwowza");w.addButton(M.cfg.wwwroot+"/filter/oidwowza/pix/fast-forward.svg",y,function(){w.seek(w.getPosition()+10)},"jw-btn-fastforward","jw-fastforward"),w.on("beforePlay",function(){p||(t(".jw-fastforward.jw-icon-inline").insertAfter(".jw-icon-playback"),t(".jw-icon-rewind.jw-icon-inline").insertBefore(".jw-icon-playback"),p=!0)});var h=new URL(window.location).searchParams;h.get("offset")&&(c=h.get("offset"),d=!0),w.on("ready",function(){!0===d&&w.play()}),w.on("firstFrame",function(){w.seek(c)}),a||g||w.on("time",function(){!g&&isFinite(w.getDuration())&&(w.seek(c),g=!0)});var j=function(){var t=parseInt(w.getPosition(),10);t===parseInt(w.getDuration(),10)&&(t="FINISHED"),M.util.set_user_preference(i,t)};setInterval(j,3e4),t(window).on("beforeunload",function(){j()})}}});